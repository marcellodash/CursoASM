ORG &8000
	DI 			; DESABILITA AS INTERRUPCOES
		EXX
		PUSH BC
		EXX
		LD HL,(&0038)	; PARA VOLTAR AO BASIC VAMOS
		PUSH HL 	; PRECISAR SALVAR O MANIPULADOR
		LD HL,(&003A)	; DE INTERRUPCAO PADRAO
		PUSH HL 	
	
		LD A,&C3	; CODIGO PARA INSTRUCAO JP
		LD (&0038),A	; CARREGA O CODIGO DA INSTRUCAO JP
				; PARA O ENDERECO DE MEMORIA DA 
				; INTERRUPCAO 
		LD HL,INTHNDL	; CODIGO QUE TRATARA A INTERRUPCAO
		LD (&0039), HL	; CARREGA O CODIGO QUE TRATARA A 
				; INTERRUPCAO NO PROXIMO ENREDECO 
				; DE MEMORIA
	EI 
	LD HL, &C0000		; PASSA A MEMORIA DE VIDEO COMO PARAM
	LD D,10			; CARREGA O CONTADOR
	LD C, %11111111		; PREPARA UMA MASCARA COM BITS LIGADOS
LOOP:
	LD A,(HL)
	XOR C			; MUDA OS BITS DO ACUMULADOR 
	LD (HL),A		
	INC HL
	LD A,H
	OR A
	JP Z,PAGEDONE
JP LOOP

PAGEDONE:
	LD HL,&C0000
	DEC D
JP NZ, LOOP
	DI
		POP HL
		LD (&003A),HL
		POP HL
		LD (&0038),HL
		EXX
		POP BC
		EXX
	EI
RET
		
INTHNDL:
	EXX			; TROCA HL,BC E DE COM HL',BC' E DE'
	EX AF,AF'		; TROCA A E F COM A' E F'
	LD HL,RASTERCOLORS :IH_RASTERCOLORS_PLUS2
	LD B,&F5 		; TODOS OS ENDERECOS DE MEMORIA QUE 
				; COMECAM COM &F5 REFENCIAM A SAIDA
				; DE VIDEO
	IN A,(C)		; NA VERDADE SIGNIFICA IN A,(BC)
	RRA			
	JP NC,INTHNDLOK
	LD HL,RASTERCOLORS
INTHNDLOK:
	LD BC, &7F00		; GATEWAY GRAFICO
	OUT (C),C		; NA VERDADE SIGNIFICA OUT (BC),C
	OUTI
	INC B
	INC C
	OUT (C),C		
	OUTI
	INC B
	INC C
	OUT (C),C		
	OUTI
	INC B
	INC C
	OUT (C),C		
	OUTI	
	LD (IH_RASTERCOLORS_PLUS2-2), HL
	EX AF, AF'
	EXX
	EI
RET

RASTERCOLORS:
	DB &4C,&43,&52,&5C,&5E,&5F ; HARDWARE COLOR
	DB &4C,&43,&52,&5C,&5E,&5F ; HARDWARE COLOR
	DB &4C,&43,&52,&5C,&5E,&5F ; HARDWARE COLOR
	DB &4C,&43,&52,&5C,&5E,&5F ; HARDWARE COLOR
	DB &4C,&43,&52,&5C,&5E,&5F ; HARDWARE COLOR
	DB &4C,&43,&52,&5C,&5E,&5F ; HARDWARE COLOR
